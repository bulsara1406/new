from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.alert import Alert
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from openpyxl import load_workbook
import time

# Load Excel file
driver = webdriver.Chrome()
workbook = load_workbook("login.xlsx")
sheet = workbook["Sheet1"]
alert= Alert(driver)
# Launch browser
wait = WebDriverWait(driver, 10)
driver.maximize_window()

# Open login URL
driver.get('http://localhost:3000/register')

# Loop through Excel rows (skip header row)
for row in sheet.iter_rows(min_row=2, values_only=True):
    username, password = row

    print("Testing with:", username, password)

    # Wait â†’ Find Name
    name_input = wait.until(EC.presence_of_element_located((By.ID, "name")))
    name_input.clear()
    name_input.send_keys("Hardik")

    # Username Field
    username_input = wait.until(EC.presence_of_element_located((By.ID, "username")))
    username_input.clear()
    username_input.send_keys(username)

    # Password Field
    password_input = wait.until(EC.presence_of_element_located((By.ID, "password")))
    password_input.clear()
    password_input.send_keys(password)

    # Submit Button
    btn = wait.until(EC.element_to_be_clickable((By.ID, "btn")))
    btn.click()
    time.sleep(1)
    alert.accept()
    time.sleep(2)

    # Reload page for next iteration
    driver.get('http://localhost:3000/register')

time.sleep(2)
driver.quit()
